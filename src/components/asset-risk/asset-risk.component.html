<div class="asset-risk">
  <section class="section-header">
    <h2>Lorem Lorem Lorem</h2>
  </section>

  <section class="flow-diagram">
    <div class="flow-container">
      <div
        class="flow-node first"
        (mouseenter)="showCard1($event)"
        (mouseleave)="hideCard()"
      >
        <svg
          width="59"
          height="60"
          viewBox="0 0 59 60"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <circle cx="26.5" cy="33.37" r="26.46" fill="#FFF1F0" />
          <path
            d="M16.1667 33.4599C16.1667 34.8965 16.7374 36.2742 17.7533 37.29C18.7691 38.3059 20.1468 38.8765 21.5834 38.8765C23.5851 38.9511 25.4992 39.7167 27.0001 41.0432C28.501 39.7167 30.4151 38.9511 32.4167 38.8765C33.8533 38.8765 35.2311 38.3059 36.2469 37.29C37.2627 36.2742 37.8334 34.8965 37.8334 33.4599V28.0432H32.4167C30.4151 28.1178 28.501 28.8834 27.0001 30.2099C25.4992 28.8834 23.5851 28.1178 21.5834 28.0432H16.1667V33.4599Z"
            stroke="#E6372B"
            stroke-width="1.625"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M20.5001 32.3765C22.1251 32.3765 23.7501 32.9182 23.7501 34.5432C21.5834 34.5432 20.5001 34.5432 20.5001 32.3765Z"
            stroke="#E6372B"
            stroke-width="1.625"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <path
            d="M33.5001 32.3765C31.8751 32.3765 30.2501 32.9182 30.2501 34.5432C32.4167 34.5432 33.5001 34.5432 33.5001 32.3765Z"
            stroke="#E6372B"
            stroke-width="1.625"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
          <circle
            cx="47.0398"
            cy="11.9102"
            r="10.5"
            fill="#7A44FF"
            stroke="#FAFAFA"
          />
          <mask
            id="mask0_1_377"
            style="mask-type: alpha"
            maskUnits="userSpaceOnUse"
            x="41"
            y="4"
            width="14"
            height="14"
          >
            <rect x="41.04" y="4.91003" width="13" height="13" fill="#D9D9D9" />
          </mask>
          <g mask="url(#mask0_1_377)">
            <path
              d="M41.5815 15.7436V14.2269C41.5815 13.92 41.6605 13.6378 41.8185 13.3805C41.9765 13.1233 42.1864 12.9269 42.4482 12.7915C43.0079 12.5116 43.5767 12.3017 44.1545 12.1618C44.7322 12.0219 45.319 11.9519 45.9149 11.9519C46.5107 11.9519 47.0975 12.0219 47.6753 12.1618C48.2531 12.3017 48.8218 12.5116 49.3815 12.7915C49.6433 12.9269 49.8532 13.1233 50.0112 13.3805C50.1692 13.6378 50.2482 13.92 50.2482 14.2269V15.7436H41.5815ZM51.3315 15.7436V14.1186C51.3315 13.7213 51.221 13.3399 50.9998 12.9743C50.7786 12.6087 50.4649 12.295 50.0586 12.0332C50.519 12.0873 50.9524 12.1799 51.3586 12.3108C51.7649 12.4417 52.144 12.6019 52.4961 12.7915C52.8211 12.972 53.0694 13.1729 53.2409 13.3941C53.4124 13.6153 53.4982 13.8568 53.4982 14.1186V15.7436H51.3315ZM45.9149 11.4102C45.319 11.4102 44.809 11.1981 44.3847 10.7738C43.9604 10.3495 43.7482 9.8394 43.7482 9.24357C43.7482 8.64774 43.9604 8.13767 44.3847 7.71336C44.809 7.28906 45.319 7.0769 45.9149 7.0769C46.5107 7.0769 47.0208 7.28906 47.4451 7.71336C47.8694 8.13767 48.0815 8.64774 48.0815 9.24357C48.0815 9.8394 47.8694 10.3495 47.4451 10.7738C47.0208 11.1981 46.5107 11.4102 45.9149 11.4102ZM51.3315 9.24357C51.3315 9.8394 51.1194 10.3495 50.6951 10.7738C50.2708 11.1981 49.7607 11.4102 49.1649 11.4102C49.0656 11.4102 48.9392 11.399 48.7857 11.3764C48.6322 11.3538 48.5058 11.329 48.4065 11.3019C48.6503 11.013 48.8376 10.6925 48.9685 10.3404C49.0994 9.98836 49.1649 9.62274 49.1649 9.24357C49.1649 8.8644 49.0994 8.49878 48.9685 8.1467C48.8376 7.79461 48.6503 7.47413 48.4065 7.18524C48.5329 7.1401 48.6593 7.11076 48.7857 7.09722C48.9121 7.08368 49.0385 7.0769 49.1649 7.0769C49.7607 7.0769 50.2708 7.28906 50.6951 7.71336C51.1194 8.13767 51.3315 8.64774 51.3315 9.24357ZM42.6649 14.6602H49.1649V14.2269C49.1649 14.1276 49.14 14.0373 49.0904 13.9561C49.0407 13.8748 48.9753 13.8116 48.894 13.7665C48.4065 13.5227 47.9145 13.3399 47.418 13.2181C46.9215 13.0962 46.4204 13.0352 45.9149 13.0352C45.4093 13.0352 44.9083 13.0962 44.4118 13.2181C43.9152 13.3399 43.4232 13.5227 42.9357 13.7665C42.8545 13.8116 42.789 13.8748 42.7394 13.9561C42.6897 14.0373 42.6649 14.1276 42.6649 14.2269V14.6602ZM45.9149 10.3269C46.2128 10.3269 46.4678 10.2208 46.68 10.0087C46.8921 9.79652 46.9982 9.54149 46.9982 9.24357C46.9982 8.94565 46.8921 8.69062 46.68 8.47847C46.4678 8.26631 46.2128 8.16024 45.9149 8.16024C45.617 8.16024 45.3619 8.26631 45.1498 8.47847C44.9376 8.69062 44.8315 8.94565 44.8315 9.24357C44.8315 9.54149 44.9376 9.79652 45.1498 10.0087C45.3619 10.2208 45.617 10.3269 45.9149 10.3269Z"
              fill="white"
            />
          </g>
        </svg>
        <div class="node-label">{{ flowAssets()[0].name }}</div>
      </div>

      <!-- Arrow -->
      <div class="flow-arrow">
        <svg
          width="59"
          height="6"
          viewBox="0 0 59 6"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M58.5 2.92004L54.75 0.754978L54.75 5.08511L58.5 2.92004ZM9.87787e-09 3.29504L55.125 3.29504L55.125 2.54504L-9.87729e-09 2.54504L9.87787e-09 3.29504Z"
            fill="#858D9D"
          />
        </svg>
      </div>

      <div
        class="flow-node"
        (mouseenter)="showCard2($event)"
        (mouseleave)="hideCard()"
      >
        <svg
          width="53"
          height="53"
          viewBox="0 0 53 53"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <circle cx="26.46" cy="26.4597" r="26.46" fill="#D7EAFF" />
          <path
            d="M20.2725 20.1676H20.2834M20.2725 33.2926H20.2834M18.085 15.7926H35.585C36.7931 15.7926 37.7725 16.772 37.7725 17.9801V22.3551C37.7725 23.5632 36.7931 24.5426 35.585 24.5426H18.085C16.8769 24.5426 15.8975 23.5632 15.8975 22.3551V17.9801C15.8975 16.772 16.8769 15.7926 18.085 15.7926ZM18.085 28.9176H35.585C36.7931 28.9176 37.7725 29.897 37.7725 31.1051V35.4801C37.7725 36.6882 36.7931 37.6676 35.585 37.6676H18.085C16.8769 37.6676 15.8975 36.6882 15.8975 35.4801V31.1051C15.8975 29.897 16.8769 28.9176 18.085 28.9176Z"
            stroke="#1873DE"
            stroke-width="2.1875"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>

        <div class="node-label">{{ flowAssets()[1].name }}</div>
      </div>

      <div class="flow-arrow">
        <svg
          width="59"
          height="6"
          viewBox="0 0 59 6"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M58.5 2.92004L54.75 0.754978L54.75 5.08511L58.5 2.92004ZM9.87787e-09 3.29504L55.125 3.29504L55.125 2.54504L-9.87729e-09 2.54504L9.87787e-09 3.29504Z"
            fill="#858D9D"
          />
        </svg>
      </div>

      <div
        class="flow-node"
        (mouseenter)="showCard3($event)"
        (mouseleave)="hideCard()"
      >
        <svg
          width="53"
          height="53"
          viewBox="0 0 53 53"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <circle cx="26.46" cy="26.4597" r="26.46" fill="#D7EAFF" />
          <path
            d="M20.2725 20.1676H20.2834M20.2725 33.2926H20.2834M18.085 15.7926H35.585C36.7931 15.7926 37.7725 16.772 37.7725 17.9801V22.3551C37.7725 23.5632 36.7931 24.5426 35.585 24.5426H18.085C16.8769 24.5426 15.8975 23.5632 15.8975 22.3551V17.9801C15.8975 16.772 16.8769 15.7926 18.085 15.7926ZM18.085 28.9176H35.585C36.7931 28.9176 37.7725 29.897 37.7725 31.1051V35.4801C37.7725 36.6882 36.7931 37.6676 35.585 37.6676H18.085C16.8769 37.6676 15.8975 36.6882 15.8975 35.4801V31.1051C15.8975 29.897 16.8769 28.9176 18.085 28.9176Z"
            stroke="#1873DE"
            stroke-width="2.1875"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>

        <div class="node-label">{{ flowAssets()[2].name }}</div>
      </div>

      <div class="flow-arrow">
        <svg
          width="208"
          height="110"
          viewBox="0 0 208 110"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M208 2.56104L204.25 4.7261L204.25 0.395972L208 2.56104ZM80.8318 55.936L-3.57102e-06 55.936L-3.52084e-06 55.186L80.8318 55.186L80.8318 55.936ZM204.625 2.93604L144.795 2.93603L144.795 2.18603L204.625 2.18604L204.625 2.93604ZM127.503 11.2585L98.7098 47.3314L98.1236 46.8635L126.917 10.7907L127.503 11.2585ZM144.795 2.93603C138.066 2.93603 131.702 5.99895 127.503 11.2585L126.917 10.7907C131.258 5.35277 137.837 2.18603 144.795 2.18603L144.795 2.93603ZM80.8318 55.186C87.5615 55.186 93.9254 52.1231 98.1236 46.8635L98.7098 47.3314C94.3692 52.7693 87.7896 55.936 80.8318 55.936L80.8318 55.186Z"
            fill="#858D9D"
          />
          <path
            d="M208 107.279L204.25 105.114L204.25 109.444L208 107.279ZM80.9605 54.9038L-3.50411e-06 54.9038L-3.45394e-06 55.6538L80.9605 55.6538L80.9605 54.9038ZM204.625 106.904L144.667 106.904L144.667 107.654L204.625 107.654L204.625 106.904ZM127.504 98.7416L98.7049 63.3427L98.1231 63.816L126.922 99.2149L127.504 98.7416ZM144.667 106.904C138.009 106.904 131.705 103.906 127.504 98.7416L126.922 99.2149C131.266 104.554 137.783 107.654 144.667 107.654L144.667 106.904ZM80.9605 55.6538C87.618 55.6538 93.9216 58.6517 98.1231 63.816L98.7049 63.3427C94.361 58.0033 87.8437 54.9038 80.9605 54.9038L80.9605 55.6538Z"
            fill="#858D9D"
          />
        </svg>
      </div>

      <div
        class="flow-branch"
        (mouseenter)="showCard4($event)"
        (mouseleave)="hideCard()"
      >
        <div class="branch-path top">
          <div class="flow-node end-node" (click)="openDrawer(flowAssets()[3])">
            <div class="">
              <svg
                width="59"
                height="59"
                viewBox="0 0 59 59"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <circle cx="26.5" cy="31.9101" r="26.46" fill="#D7EAFF" />
                <path
                  d="M19.5615 26.4298H19.5725M19.5615 37.2936H19.5725M17.374 22.8086H34.874C36.0821 22.8086 37.0615 23.6192 37.0615 24.6192V28.2405C37.0615 29.2405 36.0821 30.0511 34.874 30.0511H17.374C16.1659 30.0511 15.1865 29.2405 15.1865 28.2405V24.6192C15.1865 23.6192 16.1659 22.8086 17.374 22.8086ZM17.374 33.6724H34.874C36.0821 33.6724 37.0615 34.483 37.0615 35.483V39.1042C37.0615 40.1042 36.0821 40.9149 34.874 40.9149H17.374C16.1659 40.9149 15.1865 40.1042 15.1865 39.1042V35.483C15.1865 34.483 16.1659 33.6724 17.374 33.6724Z"
                  stroke="#1873DE"
                  stroke-width="1.81062"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <rect
                  x="37"
                  y="-0.00012207"
                  width="22"
                  height="22"
                  rx="11"
                  fill="#E6372B"
                />
                <path
                  d="M50.0623 9.43414L46.9373 12.8196M46.9373 9.43414L50.0623 12.8196M53.4998 11.8039C53.4998 15.1894 51.3123 16.8821 48.7123 17.8638C48.5761 17.9138 48.4282 17.9114 48.2935 17.8571C45.6873 16.8821 43.4998 15.1894 43.4998 11.8039V7.06435C43.4998 6.88478 43.5656 6.71256 43.6828 6.58558C43.8 6.4586 43.959 6.38727 44.1248 6.38727C45.3748 6.38727 46.9373 5.57477 48.0248 4.5456C48.1572 4.42305 48.3256 4.35571 48.4998 4.35571C48.6739 4.35571 48.8423 4.42305 48.9748 4.5456C50.0685 5.58154 51.6248 6.38727 52.8748 6.38727C53.0405 6.38727 53.1995 6.4586 53.3167 6.58558C53.4339 6.71256 53.4998 6.88478 53.4998 7.06435V11.8039Z"
                  stroke="#FFF8F7"
                  stroke-width="0.739568"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </div>
            <div class="node-details">
              <div class="node-label">{{ flowAssets()[3].name }}</div>
              <div class="node-ip">{{ flowAssets()[3].ip }}</div>
            </div>
          </div>
        </div>

        <!-- Bottom branch -->
        <div class="branch-path bottom">
          <div class="flow-node end-node" (click)="openDrawer(flowAssets()[4])">
            <div class="">
              <svg
                width="59"
                height="59"
                viewBox="0 0 59 59"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <circle cx="26.5" cy="31.9101" r="26.46" fill="#D7EAFF" />
                <path
                  d="M19.5615 26.4298H19.5725M19.5615 37.2936H19.5725M17.374 22.8086H34.874C36.0821 22.8086 37.0615 23.6192 37.0615 24.6192V28.2405C37.0615 29.2405 36.0821 30.0511 34.874 30.0511H17.374C16.1659 30.0511 15.1865 29.2405 15.1865 28.2405V24.6192C15.1865 23.6192 16.1659 22.8086 17.374 22.8086ZM17.374 33.6724H34.874C36.0821 33.6724 37.0615 34.483 37.0615 35.483V39.1042C37.0615 40.1042 36.0821 40.9149 34.874 40.9149H17.374C16.1659 40.9149 15.1865 40.1042 15.1865 39.1042V35.483C15.1865 34.483 16.1659 33.6724 17.374 33.6724Z"
                  stroke="#1873DE"
                  stroke-width="1.81062"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
                <rect
                  x="37"
                  y="-0.00012207"
                  width="22"
                  height="22"
                  rx="11"
                  fill="#E6372B"
                />
                <path
                  d="M50.0623 9.43414L46.9373 12.8196M46.9373 9.43414L50.0623 12.8196M53.4998 11.8039C53.4998 15.1894 51.3123 16.8821 48.7123 17.8638C48.5761 17.9138 48.4282 17.9114 48.2935 17.8571C45.6873 16.8821 43.4998 15.1894 43.4998 11.8039V7.06435C43.4998 6.88478 43.5656 6.71256 43.6828 6.58558C43.8 6.4586 43.959 6.38727 44.1248 6.38727C45.3748 6.38727 46.9373 5.57477 48.0248 4.5456C48.1572 4.42305 48.3256 4.35571 48.4998 4.35571C48.6739 4.35571 48.8423 4.42305 48.9748 4.5456C50.0685 5.58154 51.6248 6.38727 52.8748 6.38727C53.0405 6.38727 53.1995 6.4586 53.3167 6.58558C53.4339 6.71256 53.4998 6.88478 53.4998 7.06435V11.8039Z"
                  stroke="#FFF8F7"
                  stroke-width="0.739568"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
            </div>
            <div class="node-details">
              <div class="node-label">{{ flowAssets()[4].name }}</div>
              <div class="node-ip">{{ flowAssets()[4].ip }}</div>
            </div>
          </div>
        </div>
      </div>


    </div>


      <section class="remediation-section">
    <div class="remediation-group">
      <div class="group-header">
        <span class="group-icon">
          <svg
            width="25"
            height="26"
            viewBox="0 0 25 26"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M0 12.84C0 5.93641 5.59644 0.339966 12.5 0.339966C19.4036 0.339966 25 5.93641 25 12.84C25 19.7435 19.4036 25.34 12.5 25.34C5.59644 25.34 0 19.7435 0 12.84Z"
              fill="#E6372B"
            />
            <g clip-path="url(#clip0_1_717)">
              <path
                d="M14.2358 10.8225L10.7635 14.5841M10.7635 10.8225L14.2358 14.5841M18.0552 13.4556C18.0552 17.2172 15.6246 19.098 12.7358 20.1888C12.5845 20.2444 12.4202 20.2417 12.2705 20.1813C9.37465 19.098 6.94409 17.2172 6.94409 13.4556V8.18941C6.94409 7.98988 7.01726 7.79853 7.14749 7.65744C7.27772 7.51635 7.45436 7.43709 7.63854 7.43709C9.02742 7.43709 10.7635 6.53431 11.9719 5.3908C12.119 5.25463 12.3061 5.17981 12.4996 5.17981C12.6932 5.17981 12.8803 5.25463 13.0274 5.3908C14.2427 6.54184 15.9719 7.43709 17.3608 7.43709C17.5449 7.43709 17.7216 7.51635 17.8518 7.65744C17.982 7.79853 18.0552 7.98988 18.0552 8.18941V13.4556Z"
                stroke="#FFF8F7"
                stroke-width="1.46"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </g>
            <defs>
              <clipPath id="clip0_1_717">
                <rect
                  width="17.5"
                  height="17.5"
                  fill="white"
                  transform="translate(3.75 4.08997)"
                />
              </clipPath>
            </defs>
          </svg>
        </span>
        <span class="group-label-danger">Lorem</span>
      </div>

      <div class="group-header">
        <span class="group-icon">
          <svg
            width="25"
            height="26"
            viewBox="0 0 25 26"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M0 12.84C0 5.93641 5.59644 0.339966 12.5 0.339966C19.4036 0.339966 25 5.93641 25 12.84C25 19.7435 19.4036 25.34 12.5 25.34C5.59644 25.34 0 19.7435 0 12.84Z"
              fill="#FF9500"
            />
            <g clip-path="url(#clip0_1_725)">
              <path
                d="M14.2358 10.8225L10.7635 14.5841M10.7635 10.8225L14.2358 14.5841M18.0552 13.4556C18.0552 17.2172 15.6246 19.098 12.7358 20.1888C12.5845 20.2444 12.4202 20.2417 12.2705 20.1813C9.37465 19.098 6.94409 17.2172 6.94409 13.4556V8.18941C6.94409 7.98988 7.01726 7.79853 7.14749 7.65744C7.27772 7.51635 7.45436 7.43709 7.63854 7.43709C9.02742 7.43709 10.7635 6.53431 11.9719 5.3908C12.119 5.25463 12.3061 5.17981 12.4996 5.17981C12.6932 5.17981 12.8803 5.25463 13.0274 5.3908C14.2427 6.54184 15.9719 7.43709 17.3608 7.43709C17.5449 7.43709 17.7216 7.51635 17.8518 7.65744C17.982 7.79853 18.0552 7.98988 18.0552 8.18941V13.4556Z"
                stroke="#FFF8F7"
                stroke-width="1.46"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </g>
            <defs>
              <clipPath id="clip0_1_725">
                <rect
                  width="17.5"
                  height="17.5"
                  fill="white"
                  transform="translate(3.75 4.08997)"
                />
              </clipPath>
            </defs>
          </svg>
        </span>
        <span class="group-label-warning">Lorem</span>
      </div>

      <div class="group-header">
        <span class="group-icon">
          <svg
            width="25"
            height="26"
            viewBox="0 0 25 26"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M0 12.84C0 5.93641 5.59644 0.339966 12.5 0.339966C19.4036 0.339966 25 5.93641 25 12.84C25 19.7435 19.4036 25.34 12.5 25.34C5.59644 25.34 0 19.7435 0 12.84Z"
              fill="#02983E"
            />
            <g clip-path="url(#clip0_1_732)">
              <path
                d="M14.2766 11.4334L12.2597 14.4683L10.897 13.5711M18.3337 13.5711C18.3337 17.2169 15.7816 19.0398 12.7482 20.0971C12.5894 20.151 12.4169 20.1484 12.2597 20.0898C9.21908 19.0398 6.66699 17.2169 6.66699 13.5711V8.46692C6.66699 8.27353 6.74382 8.08807 6.88056 7.95132C7.01731 7.81458 7.20277 7.73775 7.39616 7.73775C8.85449 7.73775 10.6774 6.86275 11.9462 5.75442C12.1006 5.62244 12.2971 5.54993 12.5003 5.54993C12.7035 5.54993 12.9 5.62244 13.0545 5.75442C14.3305 6.87005 16.1462 7.73775 17.6045 7.73775C17.7979 7.73775 17.9833 7.81458 18.1201 7.95132C18.2568 8.08807 18.3337 8.27353 18.3337 8.46692V13.5711Z"
                stroke="#FFF8F7"
                stroke-width="1.46434"
                stroke-linecap="round"
                stroke-linejoin="round"
              />
            </g>
            <defs>
              <clipPath id="clip0_1_732">
                <rect
                  width="17.5"
                  height="17.5"
                  fill="white"
                  transform="translate(3.75 4.08997)"
                />
              </clipPath>
            </defs>
          </svg>
        </span>
        <span class="group-label-success">Lorem</span>
      </div>
    </div>
  </section>

  </section>

  <section class="risk-section">
    <h2>Lorem Ipsum Dolor Sit</h2>

    <div class="risk-content">
      <div class="risk-table">
        <div class="risk-table-header">
          <div class="header-cell asset">Asset</div>
          <div class="header-cell risk">Contextual Risk</div>
        </div>

        <div class="risk-table-body">
          @for (asset of riskAssets(); track $index) {
          <div class="risk-row" (click)="openDrawer(asset)">
            <div class="cell asset">
              <svg
                width="53"
                height="53"
                viewBox="0 0 53 53"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <circle cx="26.46" cy="26.4597" r="26.46" fill="#D7EAFF" />
                <path
                  d="M20.2725 20.1676H20.2834M20.2725 33.2926H20.2834M18.085 15.7926H35.585C36.7931 15.7926 37.7725 16.772 37.7725 17.9801V22.3551C37.7725 23.5632 36.7931 24.5426 35.585 24.5426H18.085C16.8769 24.5426 15.8975 23.5632 15.8975 22.3551V17.9801C15.8975 16.772 16.8769 15.7926 18.085 15.7926ZM18.085 28.9176H35.585C36.7931 28.9176 37.7725 29.897 37.7725 31.1051V35.4801C37.7725 36.6882 36.7931 37.6676 35.585 37.6676H18.085C16.8769 37.6676 15.8975 36.6882 15.8975 35.4801V31.1051C15.8975 29.897 16.8769 28.9176 18.085 28.9176Z"
                  stroke="#1873DE"
                  stroke-width="2.1875"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                />
              </svg>
              <div class="asset-details">
                <div class="asset-name">{{ asset.name }}</div>
                <div class="asset-ip">{{ asset.ip }}</div>
              </div>
            </div>
            <div class="cell risk">
              <div class="risk-badge {{ asset.riskLevel?.toLowerCase() }}">
                {{ asset.riskLevel }}
              </div>
            </div>
          </div>
          }
        </div>

        <div class="risk-table-footer">
          <div class="pagination">
            <button
              class="page-nav"
              [disabled]="currentPage() === 1"
              (click)="prevPage()"
              aria-label="Previous page"
            >
              <svg
                width="7"
                height="11"
                viewBox="0 0 7 11"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M5.66585 0.839966L6.83252 2.00663L2.99919 5.83997L6.83252 9.6733L5.66585 10.84L0.665854 5.83997L5.66585 0.839966Z"
                  fill="#C2C6CE"
                />
              </svg>
            </button>
            <span class="page-info"
              >Showing {{ currentPage() }}-{{ currentPage() }} of
              {{ totalPages() }}</span
            >
            <button
              class="page-nav"
              [disabled]="currentPage() === totalPages()"
              (click)="nextPage()"
              aria-label="Next page"
            >
              <svg
                width="7"
                height="11"
                viewBox="0 0 7 11"
                fill="none"
                xmlns="http://www.w3.org/2000/svg"
              >
                <path
                  d="M1.33415 10.84L0.16748 9.6733L4.00081 5.83997L0.16748 2.00663L1.33415 0.839966L6.33415 5.83997L1.33415 10.84Z"
                  fill="#858D9D"
                />
              </svg>
            </button>
          </div>
        </div>
      </div>

      <div class="risk-summary">
        <h3>Contextual Risk</h3>

        <div class="d-flex">
          <div class="risk-legend">
            @for (risk of riskCounts(); track $index) {
            <div class="legend-item">
              <span
                class="legend-color"
                [style.background-color]="risk.color"
              ></span>
              <span class="legend-count">{{ risk.count }}</span>
              <span class="legend-label">{{ risk.level }}</span>
            </div>
            }
          </div>
          <div class="donut-chart">
            <div class="donut-value">{{ totalRiskCount() }}</div>

            <svg viewBox="0 0 36 36" class="donut">
              <circle
                cx="18"
                cy="18"
                r="15.91549430918954"
                fill="transparent"
                stroke="#f3f3f3"
                stroke-width="3"
              ></circle>

              <!-- Add segments based on risk counts -->
              @if (riskCounts()[0].count > 0) {
              <circle
                cx="18"
                cy="18"
                r="15.91549430918954"
                fill="transparent"
                [attr.stroke]="riskCounts()[0].color"
                stroke-width="3"
                stroke-dasharray="100 0"
                stroke-dashoffset="25"
              ></circle>
              }
            </svg>
          </div>
        </div>
      </div>
    </div>
  </section>



  @if (showDrawer()) {
  <div class="drawer-overlay" (click)="closeDrawer()"></div>
  <div class="vulnerability-drawer">
    <div class="drawer-header">
      <h3>{{ selectedAsset()?.name }}</h3>
      <button
        class="close-button"
        (click)="closeDrawer()"
        aria-label="Close drawer"
      >
        <span class="material-icons">close</span>
      </button>
    </div>

    <div class="drawer-content">
      <div class="asset-details">
        <div class="detail-item">
          <span class="detail-label">IP Address:</span>
          <span class="detail-value">{{ selectedAsset()?.ip }}</span>
        </div>
        <div class="detail-item">
          <span class="detail-label">Risk Level:</span>
          <span class="detail-value">
            <span
              class="risk-badge {{ selectedAsset()?.riskLevel?.toLowerCase() }}"
            >
              {{ selectedAsset()?.riskLevel }}
            </span>
          </span>
        </div>
      </div>

      <div class="vulnerability-list">
        <h4>Vulnerabilities</h4>
        <div class="vulnerability-item">
          <div class="vuln-header">
            <span class="vuln-id">CVE-2023-1234</span>
            <span class="vuln-severity critical">Critical</span>
          </div>
          <div class="vuln-description">
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nullam
            euismod, nunc nec ultrices.
          </div>
        </div>

        <div class="vulnerability-item">
          <div class="vuln-header">
            <span class="vuln-id">CVE-2023-5678</span>
            <span class="vuln-severity critical">Critical</span>
          </div>
          <div class="vuln-description">
            Tempus a id adipiscing fames egestas tellus dis pretium tempus.
          </div>
        </div>
      </div>
    </div>
  </div>
  }

  <div class="hover-card-container">
    <app-hover-card
      [isVisible]="hoverService.isVisible()"
      [assetName]="hoverService.data()?.assetName || ''"
      [ipAddress]="hoverService.data()?.ipAddress"
      [hasRisk]="hoverService.data()?.hasRisk || false"
      [loremItems]="hoverService.data()?.loremItems || []"
      [additionalSections]="hoverService.data()?.additionalSections || []"
    ></app-hover-card>
  </div>
</div>
